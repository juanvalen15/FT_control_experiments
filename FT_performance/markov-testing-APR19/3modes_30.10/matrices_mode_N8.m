%% n = 8

%% transition matrix n=8 -> 23 states

% initialization
states = 23;

m = zeros(states,states);
t = zeros(states,states);


% probabilities
m(1,2) = Pfm(1);
m(1,9) = 1-Pfm(1);

m(2,3) = Pfm(2);
m(2,10) = 1-Pfm(2);

m(3,4) = Pfm(3);
m(3,11) = 1-Pfm(3);

m(4,5) = Pfm(4);
m(4,12) = 1-Pfm(4);

m(5,6) = Pfm(5);
m(5,13) = 1-Pfm(5);

m(6,7) = Pfm(6);
m(6,14) = 1-Pfm(6);

m(7,8) = Pfm(7);
m(7,15) = 1-Pfm(7);

m(8,16) = 1-Pfm(8);
m(8,23) = Pfm(8);

m(9,9) = 1-(x(1)+y(1));
if f(1)-1 == 0
  m(9,10) = 1-Pfm(1);
  m(9,23) = Pfm(1);
else
  m(9,9) = x(1);
  m(9,23) = y(1);
end

m(10,10) = 1-(x(2)+y(2));
if f(2)-1 == 0
    m(10,17) = 1-Pfm(2);
    m(10,23) = Pfm(2);
else
    m(10,17) = x(2);
    m(10,23) = y(2);
end


m(11,11) = 1-(x(3)+y(3));
if f(3)-1 == 0
    m(11,18) = 1-Pfm(3);
    m(11,23) = Pfm(3);
else
    m(11,18) = x(3);
    m(11,23) = y(3);    
end


m(12,12) = 1-(x(4)+y(4));
if f(4)-1 == 0
    m(12,19) = 1-Pfm(4);
    m(12,23) = Pfm(4);
else
    m(12,19) = x(4);
    m(12,23) = y(4);    
end

m(13,13) = 1-(x(5)+y(5));
if f(5)-1 == 0
    m(13,20)  = 1-Pfm(5);
    m(13,23) = Pfm(5);
else
    m(13,20)  = x(5);
    m(13,23) = y(5);    
end

m(14,14) = 1-(x(6)+y(6));
if f(6)-1 == 0
    m(14,21)  = 1-Pfm(6);
    m(14,23) = Pfm(6);
else
    m(14,21)  = x(6);
    m(14,23) = y(6);    
end

m(15,15) = 1-(x(7)+y(7));
if f(7)-1 == 0
    m(15,22)  = 1-Pfm(7);
    m(15,23) = Pfm(7);
else
    m(15,22)  = x(7);
    m(15,23) = y(7);    
end

m(16,16) = 1-(x(8)+y(8));
if f(8)-1 == 0
    m(16,15)  = 1-Pfm(8);
    m(16,23) = Pfm(8);
else
    m(16,15)  = x(8);
    m(16,23) = y(8);    
end


m(17,9) = 1-Pfm(2);
m(17,11) = Pfm(2);

m(18,10) = 1-Pfm(3);
m(18,12) = Pfm(3);

m(19,11) = 1-Pfm(4);
m(19,13) = Pfm(4);

m(20,12) = 1-Pfm(5);
m(20,14) = Pfm(5);

m(21,13) = 1-Pfm(6);
m(21,15) = Pfm(6);

m(22,14) = 1-Pfm(7);
m(22,16) = Pfm(7);

m(23,23) = 1;

M_N8 = m;


    
% time    
t(1,2) = tm(1);
t(1,9) = tm(1);

t(2,3) = tm(2);
t(2,10) = tm(2);

t(3,4) = tm(3);
t(3,11) = tm(3);

t(4,5) = tm(4);
t(4,12) = tm(4);

t(5,6) = tm(5);
t(5,13) = tm(5);

t(6,7) = tm(6);
t(6,14) = tm(6);

t(7,8) = tm(7);
t(7,15) = tm(7);

t(8,16) = tm(8);
t(8,23) = tm(8);

if f(1)-1 == 0
  t(9,9) = tm(1);
  t(9,10) = tm(1);
  t(9,23) = tm(1);
else
  t(9,9) = tm(1) * (f(1)-1);
  t(9,10) = tm(1) * (f(1)-1);
  t(9,23) = tm(1) * (f(1)-1);
end


if f(2)-1 == 0
    t(10,10) = tm(2);
    t(10,17) = tm(2);
    t(10,23) = tm(2);
else
    t(10,10) = tm(2) * (f(2)-1);
    t(10,17) = tm(2) * (f(2)-1);
    t(10,23) = tm(2) * (f(2)-1);
end


if f(3)-1 == 0
    t(11,11) = tm(3);
    t(11,18) = tm(3);
    t(11,23) = tm(3);
else
    t(11,11) = tm(3) * (f(3)-1);
    t(11,18) = tm(3) * (f(3)-1);
    t(11,23) = tm(3) * (f(3)-1);
end


if f(4)-1 == 0
    t(12,12) = tm(4);
    t(12,19) = tm(4);
    t(12,23) = tm(4);
else
    t(12,13) = tm(4) * (f(4)-1);
    t(12,19) = tm(4) * (f(4)-1);
    t(12,20) = tm(4) * (f(4)-1);
end


if f(5)-1 == 0
    t(13,13) = tm(5);
    t(13,20)  = tm(5);
    t(13,23) = tm(5);
else
    t(13,13) = tm(5) * (f(5)-1);
    t(13,20)  = tm(5) * (f(5)-1);
    t(13,23) = tm(5) * (f(5)-1);
end


if f(6)-1 == 0
    t(14,14) = tm(6);
    t(14,21)  = tm(6);
    t(14,23) = tm(6);
else
    t(14,14) = tm(6) * (f(6)-1);
    t(14,21)  = tm(6) * (f(6)-1);
    t(14,23) = tm(6) * (f(6)-1);
end


if f(7)-1 == 0
    t(15,15) = tm(7);
    t(15,22)  = tm(7);
    t(15,23) = tm(7);
else
    t(15,15) = tm(7) * (f(7)-1);
    t(15,22)  = tm(7) * (f(7)-1);
    t(15,23) = tm(7) * (f(7)-1);
end

if f(8)-1 == 0
    t(16,16) = tm(8);
    t(16,15)  = tm(8);
    t(16,23) = tm(8);
else
    t(16,16) = tm(8) * (f(8)-1);
    t(16,15)  = tm(8) * (f(8)-1);
    t(16,23) = tm(8) * (f(8)-1);
end

t(17,9) = tm(2);
t(17,11) = tm(2);

t(18,10) = tm(3);
t(18,12) = tm(3);

t(19,11) = tm(4);
t(19,13) = tm(4);

t(20,12) = tm(5);
t(20,14) = tm(5);

t(21,13) = tm(6);
t(21,15) = tm(6);

t(22,14) = tm(7);
t(22,16) = tm(7);

T_N8 = t;

