%% n = 6

%% transition matrix n=6 -> 17 states

% initialization
states = 17;

m = zeros(states,states);
t = zeros(states,states);


% probabilities
m(1,2) = Pfm(1);
m(1,7) = 1-Pfm(1);

m(2,3) = Pfm(2);
m(2,8) = 1-Pfm(2);

m(3,4) = Pfm(3);
m(3,9) = 1-Pfm(3);

m(4,5) = Pfm(4);
m(4,10) = 1-Pfm(4);

m(5,6) = Pfm(5);
m(5,11) = 1-Pfm(5);

m(6,12) = 1-Pfm(6);
m(6,17) = Pfm(6);

m(7,7) = 1-(x(1)+y(1));
if f(1)-1 == 0
  m(7,8) = 1-Pfm(1);
  m(7,17) = Pfm(1);
else
  m(7,8) = x(1);
  m(7,17) = y(1);
end

m(8,8) = 1-(x(2)+y(2));
if f(2)-1 == 0
    m(8,13) = 1-Pfm(2);
    m(8,17) = Pfm(2);
else
    m(8,13) = x(2);
    m(8,17) = y(2);
end


m(9,9) = 1-(x(3)+y(3));
if f(3)-1 == 0
    m(9,14) = 1-Pfm(3);
    m(9,17) = Pfm(3);
else
    m(9,14) = x(3);
    m(9,17) = y(3);    
end


m(10,10) = 1-(x(4)+y(4));
if f(4)-1 == 0
    m(10,15) = 1-Pfm(4);
    m(10,17) = Pfm(4);
else
    m(10,15) = x(4);
    m(10,17) = y(4);    
end

m(11,11) = 1-(x(5)+y(5));
if f(5)-1 == 0
    m(11,16)  = 1-Pfm(5);
    m(11,17) = Pfm(5);
else
    m(11,16)  = x(5);
    m(11,17) = y(5);    
end

m(12,12) = 1-(x(6)+y(6));
if f(6)-1 == 0
    m(12,11)  = 1-Pfm(6);
    m(12,17) = Pfm(6);
else
    m(12,11)  = x(6);
    m(12,17) = y(6);    
end

m(13,7) = 1-Pfm(2);
m(13,9) = Pfm(2);

m(14,8) = 1-Pfm(3);
m(14,10) = Pfm(3);

m(15,9) = 1-Pfm(4);
m(15,11) = Pfm(4);

m(16,10) = 1-Pfm(5);
m(16,12) = Pfm(5);

m(17,17) = 1;

M_N6 = m;


    
% time    
t(1,2) = tm(1);
t(1,7) = tm(1);

t(2,3) = tm(2);
t(2,8) = tm(2);

t(3,4) = tm(3);
t(3,9) = tm(3);

t(4,5) = tm(4);
t(4,10) = tm(4);

t(5,6) = tm(5);
t(5,11) = tm(5);

t(6,12) = tm(6);
t(6,17) = tm(6);

if f(1)-1 == 0
  t(7,7) = tm(1);
  t(7,8) = tm(1);
  t(7,17) = tm(1);
else
  t(7,7) = tm(1) * (f(1)-1);
  t(7,8) = tm(1) * (f(1)-1);
  t(7,17) = tm(1) * (f(1)-1);
end


if f(2)-1 == 0
    t(8,8) = tm(2);
    t(8,13) = tm(2);
    t(8,17) = tm(2);
else
    t(8,8) = tm(2) * (f(2)-1);
    t(8,13) = tm(2) * (f(2)-1);
    t(8,17) = tm(2) * (f(2)-1);
end


if f(3)-1 == 0
    t(9,9) = tm(3);
    t(9,14) = tm(3);
    t(9,17) = tm(3);
else
    t(9,9) = tm(3) * (f(3)-1);
    t(9,14) = tm(3) * (f(3)-1);
    t(9,17) = tm(3) * (f(3)-1);
end


if f(4)-1 == 0
    t(10,10) = tm(4);
    t(10,15) = tm(4);
    t(10,17) = tm(4);
else
    t(10,10) = tm(4) * (f(4)-1);
    t(10,15) = tm(4) * (f(4)-1);
    t(10,17) = tm(4) * (f(4)-1);
end


if f(5)-1 == 0
    t(11,11) = tm(5);
    t(11,16)  = tm(5);
    t(11,17) = tm(5);
else
    t(11,11) = tm(5) * (f(5)-1);
    t(11,16)  = tm(5) * (f(5)-1);
    t(11,17) = tm(5) * (f(5)-1);
end


if f(6)-1 == 0
    t(12,12) = tm(6);
    t(12,11)  = tm(6);
    t(12,17) = tm(6);
else
    t(12,12) = tm(6) * (f(6)-1);
    t(12,11)  = tm(6) * (f(6)-1);
    t(12,17) = tm(6) * (f(6)-1);
end

t(13,7) = tm(2);
t(13,9) = tm(2);

t(14,8) = tm(3);
t(14,10) = tm(3);

t(15,9) = tm(4);
t(15,11) = tm(4);

t(16,10) = tm(5);
t(16,12) = tm(5);

T_N6 = t;

