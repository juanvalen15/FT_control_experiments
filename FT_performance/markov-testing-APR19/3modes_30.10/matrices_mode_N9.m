%% n = 9

%% transition matrix n=9 -> 26 states

% initialization
states = 26;

m = zeros(states,states);
t = zeros(states,states);


% probabilities
m(1,2) = Pfm(1);
m(1,10) = 1-Pfm(1);

m(2,3) = Pfm(2);
m(2,11) = 1-Pfm(2);

m(3,4) = Pfm(3);
m(3,12) = 1-Pfm(3);

m(4,5) = Pfm(4);
m(4,13) = 1-Pfm(4);

m(5,6) = Pfm(5);
m(5,14) = 1-Pfm(5);

m(6,7) = Pfm(6);
m(6,15) = 1-Pfm(6);

m(7,8) = Pfm(7);
m(7,16) = 1-Pfm(7);

m(8,9) = Pfm(8);
m(8,17) = 1-Pfm(8);

m(9,26) = Pfm(9);
m(9,18) = 1-Pfm(9);

m(10,10) = 1-(x(1)+y(1));
if f(1)-1 == 0
  m(10,11) = 1-Pfm(1);
  m(10,26) = Pfm(1);
else
  m(10,11) = x(1);
  m(10,26) = y(1);
end

m(11,11) = 1-(x(2)+y(2));
if f(2)-1 == 0
    m(11,19) = 1-Pfm(2);
    m(11,26) = Pfm(2);
else
    m(11,19) = x(2);
    m(11,26) = y(2);
end


m(12,12) = 1-(x(3)+y(3));
if f(3)-1 == 0
    m(12,20) = 1-Pfm(3);
    m(12,26) = Pfm(3);
else
    m(12,20) = x(3);
    m(12,26) = y(3);    
end


m(13,13) = 1-(x(4)+y(4));
if f(4)-1 == 0
    m(13,21) = 1-Pfm(4);
    m(13,26) = Pfm(4);
else
    m(13,21) = x(4);
    m(13,26) = y(4);    
end

m(14,14) = 1-(x(5)+y(5));
if f(5)-1 == 0
    m(14,22)  = 1-Pfm(5);
    m(14,26) = Pfm(5);
else
    m(14,22)  = x(5);
    m(14,26) = y(5);    
end

m(15,15) = 1-(x(6)+y(6));
if f(6)-1 == 0
    m(15,23)  = 1-Pfm(6);
    m(15,26) = Pfm(6);
else
    m(15,23)  = x(6);
    m(15,26) = y(6);    
end

m(16,16) = 1-(x(7)+y(7));
if f(7)-1 == 0
    m(16,24)  = 1-Pfm(7);
    m(16,26) = Pfm(7);
else
    m(16,24)  = x(7);
    m(16,26) = y(7);    
end

m(17,17) = 1-(x(8)+y(8));
if f(8)-1 == 0
    m(17,25)  = 1-Pfm(8);
    m(17,26) = Pfm(8);
else
    m(17,25)  = x(8);
    m(17,26) = y(8);    
end

m(18,18) = 1-(x(9)+y(9));
if f(9)-1 == 0
    m(18,17)  = 1-Pfm(9);
    m(18,26) = Pfm(9);
else
    m(18,17)  = x(9);
    m(18,26) = y(9);    
end

m(19,10) = 1-Pfm(2);
m(19,12) = Pfm(2);

m(20,11) = 1-Pfm(3);
m(20,13) = Pfm(3);

m(21,12) = 1-Pfm(4);
m(21,14) = Pfm(4);

m(22,13) = 1-Pfm(5);
m(22,15) = Pfm(5);

m(23,14) = 1-Pfm(6);
m(23,16) = Pfm(6);

m(24,15) = 1-Pfm(7);
m(24,17) = Pfm(7);

m(25,16) = 1-Pfm(8);
m(25,18) = Pfm(8);

m(26,26) = 1;

M_N9 = m;


    
% time    
t(1,2) = tm(1);
t(1,10) = tm(1);

t(2,3) = tm(2);
t(2,11) = tm(2);

t(3,4) = tm(3);
t(3,12) = tm(3);

t(4,5) = tm(4);
t(4,13) = tm(4);

t(5,6) = tm(5);
t(5,14) = tm(5);

t(6,7) = tm(6);
t(6,15) = tm(6);

t(7,8) = tm(7);
t(7,16) = tm(7);

t(8,9) = tm(8);
t(8,17) = tm(8);

t(9,18) = tm(9);
t(9,26) = tm(9);

if f(1)-1 == 0
  t(10,10) = tm(1);
  t(10,11) = tm(1);
  t(10,26) = tm(1);
else
  t(10,10) = tm(1) * (f(1)-1);
  t(10,11) = tm(1) * (f(1)-1);
  t(10,26) = tm(1) * (f(1)-1);
end


if f(2)-1 == 0
    t(11,11) = tm(2);
    t(11,19) = tm(2);
    t(11,26) = tm(2);
else
    t(11,11) = tm(2) * (f(2)-1);
    t(11,19) = tm(2) * (f(2)-1);
    t(11,26) = tm(2) * (f(2)-1);
end


if f(3)-1 == 0
    t(12,12) = tm(3);
    t(12,20) = tm(3);
    t(12,26) = tm(3);
else
    t(12,11) = tm(3) * (f(3)-1);
    t(12,20) = tm(3) * (f(3)-1);
    t(12,26) = tm(3) * (f(3)-1);
end


if f(4)-1 == 0
    t(13,13) = tm(4);
    t(13,21) = tm(4);
    t(13,26) = tm(4);
else
    t(13,13) = tm(4) * (f(4)-1);
    t(13,21) = tm(4) * (f(4)-1);
    t(13,26) = tm(4) * (f(4)-1);
end


if f(5)-1 == 0
    t(14,14) = tm(5);
    t(14,22)  = tm(5);
    t(14,26) = tm(5);
else
    t(14,14) = tm(5) * (f(5)-1);
    t(14,22)  = tm(5) * (f(5)-1);
    t(14,26) = tm(5) * (f(5)-1);
end


if f(6)-1 == 0
    t(15,15) = tm(6);
    t(15,23)  = tm(6);
    t(15,26) = tm(6);
else
    t(15,15) = tm(6) * (f(6)-1);
    t(15,23)  = tm(6) * (f(6)-1);
    t(15,26) = tm(6) * (f(6)-1);
end


if f(7)-1 == 0
    t(16,16) = tm(7);
    t(16,24)  = tm(7);
    t(16,23) = tm(7);
else
    t(16,16) = tm(7) * (f(7)-1);
    t(16,24)  = tm(7) * (f(7)-1);
    t(16,26) = tm(7) * (f(7)-1);
end

if f(8)-1 == 0
    t(17,17) = tm(8);
    t(17,25)  = tm(8);
    t(17,26) = tm(8);
else
    t(17,17) = tm(8) * (f(8)-1);
    t(17,25)  = tm(8) * (f(8)-1);
    t(17,26) = tm(8) * (f(8)-1);
end

if f(9)-1 == 0
    t(18,18) = tm(9);
    t(18,17)  = tm(9);
    t(18,26) = tm(9);
else
    t(18,18) = tm(9) * (f(9)-1);
    t(18,17)  = tm(9) * (f(9)-1);
    t(18,26) = tm(9) * (f(9)-1);
end

t(19,10) = tm(2);
t(19,12) = tm(2);

t(20,11) = tm(3);
t(20,13) = tm(3);

t(21,12) = tm(4);
t(21,14) = tm(4);

t(22,13) = tm(5);
t(22,15) = tm(5);

t(23,14) = tm(6);
t(23,16) = tm(6);

t(24,15) = tm(7);
t(24,17) = tm(7);

t(25,16) = tm(8);
t(25,18) = tm(8);

T_N9 = t;

