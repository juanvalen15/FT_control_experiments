%% clear
clear all;
close all;
clc;

%% Ps	n	FT error [rad]	BL error (n = 1) [rad]	FT error - normalized	BL error - normalized
data_set = [...
0.1	2	0.8686	0.8305	0.0715	0.0065;...
0.2	2	1.0188	0.8808	0.0838	0.0069;...
0.3	2	1.2113	0.9902	0.0996	0.0078;...
0.4	2	1.3712	1.2643	0.1128	0.0099;...
0.5	2	1.7217	2.4933	0.1416	0.0196;...
0.6	2	3.1306	5.2113	0.2575	0.0409;...
0.7	2	12.1559	127.4365	1.0000	1.0000;...
0.1	3	0.4146	0.8305	0.0341	0.0065;...
0.2	3	0.4622	0.8808	0.0380	0.0069;...
0.3	3	0.5610	0.9902	0.0462	0.0078;...
0.4	3	0.6985	1.2643	0.0575	0.0099;...
0.5	3	0.8843	2.4933	0.0727	0.0196;...
0.6	3	1.5845	5.2113	0.1303	0.0409;...
0.7	3	6.9238	127.4365	0.5696	1.0000;...
0.1	4	0.2073	0.8305	0.0171	0.0065;...
0.2	4	0.2288	0.8808	0.0188	0.0069;...
0.3	4	0.2619	0.9902	0.0215	0.0078;...
0.4	4	0.3197	1.2643	0.0263	0.0099;...
0.5	4	0.4044	2.4933	0.0333	0.0196;...
0.6	4	0.8290	5.2113	0.0682	0.0409;...
0.7	4	3.4062	127.4365	0.2802	1.0000;...
0.1	5	0.1054	0.8305	0.0087	0.0065;...
0.2	5	0.1160	0.8808	0.0095	0.0069;...
0.3	5	0.1314	0.9902	0.0108	0.0078;...
0.4	5	0.1713	1.2643	0.0141	0.0099;...
0.5	5	0.2009	2.4933	0.0165	0.0196;...
0.6	5	0.4551	5.2113	0.0374	0.0409;...
0.7	5	1.8391	127.4365	0.1513	1.0000;...
0.1	6	0.0510	0.8305	0.0042	0.0065;...
0.2	6	0.0539	0.8808	0.0044	0.0069;...
0.3	6	0.0615	0.9902	0.0051	0.0078;...
0.4	6	0.0796	1.2643	0.0065	0.0099;...
0.5	6	0.0875	2.4933	0.0072	0.0196;...
0.6	6	0.1758	5.2113	0.0145	0.0409;...
0.7	6	0.7411	127.4365	0.0610	1.0000;...
0.1	7	0.0257	0.8305	0.0021	0.0065;...
0.2	7	0.0268	0.8808	0.0022	0.0069;...
0.3	7	0.0302	0.9902	0.0025	0.0078;...
0.4	7	0.0373	1.2643	0.0031	0.0099;...
0.5	7	0.0536	2.4933	0.0044	0.0196;...
0.6	7	0.1131	5.2113	0.0093	0.0409;...
0.7	7	0.5530	127.4365	0.0455	1.0000;...
0.1	8	0.0124	0.8305	0.0010	0.0065;...
0.2	8	0.0129	0.8808	0.0011	0.0069;...
0.3	8	0.0143	0.9902	0.0012	0.0078;...
0.4	8	0.0174	1.2643	0.0014	0.0099;...
0.5	8	0.0235	2.4933	0.0019	0.0196;...
0.6	8	0.0409	5.2113	0.0034	0.0409;...
0.7	8	0.1543	127.4365	0.0127	1.0000;...
0.1	9	0.0068	0.8305	0.0006	0.0065;...
0.2	9	0.0073	0.8808	0.0006	0.0069;...
0.3	9	0.0083	0.9902	0.0007	0.0078;...
0.4	9	0.0106	1.2643	0.0009	0.0099;...
0.5	9	0.0149	2.4933	0.0012	0.0196;...
0.6	9	0.0316	5.2113	0.0026	0.0409;...
0.7	9	0.0861	127.4365	0.0071	1.0000;...
0.1	10	0.0035	0.8305	0.0003	0.0065;...
0.2	10	0.0039	0.8808	0.0003	0.0069;...
0.3	10	0.0040	0.9902	0.0003	0.0078;...
0.4	10	0.0046	1.2643	0.0004	0.0099;...
0.5	10	0.0064	2.4933	0.0005	0.0196;...
0.6	10	0.0110	5.2113	0.0009	0.0409;...
0.7	10	0.0484	127.4365	0.0040	1.0000;...
];

%%
figure;

Ps_axis = [.1 .2 .3 .4 .5 .6 .7];

subplot(2,4,1);
semilogy(Ps_axis,data_set(find(data_set(:,2) == 2),[5 6]),'-*','LineWidth', 3, 'MarkerSize', 7);
legend('FT', 'BL','Location', 'NorthWest'); grid on;title('n=2');
xlabel('Ps [probability]'); ylabel('Normalized error');

subplot(2,4,2);
semilogy(Ps_axis,data_set(find(data_set(:,2) == 3),[5 6]),'-*','LineWidth', 3, 'MarkerSize', 7);
legend('FT', 'BL','Location', 'NorthWest'); grid on;title('n=3');
xlabel('Ps [probability]'); ylabel('Normalized error');

subplot(2,4,3);
semilogy(Ps_axis,data_set(find(data_set(:,2) == 4),[5 6]),'-*','LineWidth', 3, 'MarkerSize', 7);
legend('FT', 'BL','Location', 'NorthWest'); grid on;title('n=4');
xlabel('Ps [probability]'); ylabel('Normalized error');

subplot(2,4,4);
semilogy(Ps_axis,data_set(find(data_set(:,2) == 5),[5 6]),'-*','LineWidth', 3, 'MarkerSize', 7);
legend('FT', 'BL','Location', 'NorthWest'); grid on;title('n=5');
xlabel('Ps [probability]'); ylabel('Normalized error');


%
subplot(2,4,5);
semilogy(Ps_axis,data_set(find(data_set(:,2) == 6),[5 6]),'-*','LineWidth', 3, 'MarkerSize', 7);
legend('FT', 'BL','Location', 'NorthWest'); grid on;title('n=6');
xlabel('Ps [probability]'); ylabel('Normalized error');

subplot(2,4,6);
semilogy(Ps_axis,data_set(find(data_set(:,2) == 7),[5 6]),'-*','LineWidth', 3, 'MarkerSize', 7);
legend('FT', 'BL','Location', 'NorthWest'); grid on;title('n=7');
xlabel('Ps [probability]'); ylabel('Normalized error');

subplot(2,4,7);
semilogy(Ps_axis,data_set(find(data_set(:,2) == 8),[5 6]),'-*','LineWidth', 3, 'MarkerSize', 7);
legend('FT', 'BL','Location', 'NorthWest'); grid on;title('n=8');
xlabel('Ps [probability]'); ylabel('Normalized error');

subplot(2,4,8);
semilogy(Ps_axis,data_set(find(data_set(:,2) == 9),[5 6]),'-*','LineWidth', 3, 'MarkerSize', 7);
legend('FT', 'BL','Location', 'NorthWest'); grid on;title('n=9');
xlabel('Ps [probability]'); ylabel('Normalized error');



