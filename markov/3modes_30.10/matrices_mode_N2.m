%% n = 2

%% transition matrix n=2 -> 9 states
m_01_01 = 0;
m_01_02 = Pfm(1);
m_01_03 = 1-Pfm(1);
m_01_04 = 0;
m_01_05 = 0;

m_02_01 = 0;
m_02_02 = 0;
m_02_03 = 0;
m_02_04 = 1-Pfm(2);
m_02_05 = Pfm(2);

m_03_01 = 0;
m_03_02 = 0;
m_03_03 = 1-(x1+y1);
if f(1)-1 == 0
  m_03_04 = 1-Pfm(1);
  m_03_05 = Pfm(1);
else
  m_03_04 = x1;
  m_03_05 = y1;
end


m_04_01 = 0;
m_04_02 = 0;
m_04_04 = 1-(x2+y2);
if f(2)-1 == 0
  m_04_03 = 1-Pfm(2);
  m_04_05 = Pfm(2);
else
  m_04_03 = x2;
  m_04_05 = y2;
end

m_05_01 = 0;
m_05_02 = 0;
m_05_03 = 0;
m_05_04 = 0;
m_05_05 = 1;


M_N2 = [
    m_01_01 m_01_02 m_01_03 m_01_04 m_01_05; ...
    m_02_01 m_02_02 m_02_03 m_02_04 m_02_05; ...
    m_03_01 m_03_02 m_03_03 m_03_04 m_03_05; ...
    m_04_01 m_04_02 m_04_03 m_04_04 m_04_05; ...
    m_05_01 m_05_02 m_05_03 m_05_04 m_05_05
    ];


% time
t_01_01 = 0;
t_01_02 = tm(1);
t_01_03 = tm(1);
t_01_04 = 0;
t_01_05 = 0;

t_02_01 = 0;
t_02_02 = 0;
t_02_03 = 0;
t_02_04 = tm(2);
t_02_05 = tm(2);

t_03_01 = 0;
t_03_02 = 0;
t_03_03 = tm(1);
if f(1)-1 == 0
  t_03_04 = tm(1);
  t_03_05 = tm(1);
else
  t_03_04 = tm(1)* (f(1)-1);
  t_03_05 = tm(1)* (f(1)-1);
end


t_04_01 = 0;
t_04_02 = 0;
t_04_04 = tm(2);
if f(2)-1 == 0
  t_04_03 = tm(2);
  t_04_05 = tm(2);
else
  t_04_03 = tm(2) * (f(2)-1);
  t_04_05 = tm(2) * (f(2)-1);
end


t_05_01 = 0;
t_05_02 = 0;
t_05_03 = 0;
t_05_04 = 0;
t_05_05 = 0;


T_N2 = [
    t_01_01 t_01_02 t_01_03 t_01_04 t_01_05; ...
    t_02_01 t_02_02 t_02_03 t_02_04 t_02_05; ...
    t_03_01 t_03_02 t_03_03 t_03_04 t_03_05; ...
    t_04_01 t_04_02 t_04_03 t_04_04 t_04_05; ...
    t_05_01 t_05_02 t_05_03 t_05_04 t_05_05
    ];
